mui.init();if(window.plus){plusReady()}else{document.addEventListener("plusready",plusReady,false)}function plusReady(){var e={classify_code:"XCYWTP",page_num:"1",page_size:"4"};closeMainGes()}$(function(){var e={classify_code:"XCYWTP",page_num:"1",page_size:"4"};postServer("/api/v1/news/kx/focus/list",e,bannerfn);postServer("/api/v1/news/kx/focus/menu/list",{},menuSfn);$.ajax({type:"post",url:"http://172.17.20.115/api/v1/news/kx/focus/menu/list",async:true,success:function(e){console.log(e)},error:function(e){console.log(e)}})});function menuSfn(e){console.log(e);var i=e;var n="";var t="";for(var s=0;s<i.LIST.length;s++){n+="<a class='mui-control-item' href='#item"+s+"' datacode='"+i.LIST[s].classify_code+"'>"+i.LIST[s].classify_name+"</a>";t+="<div id='item"+s+"' class='mui-slider-item mui-control-content'><div id='scroll"+s+"' class='mui-scroll-wrapper'><div class='mui-scroll'></div></div></div>"}document.getElementById("menuControl").innerHTML=n;document.getElementById("news").innerHTML=t;console.log(document.querySelector("a.mui-control-item").length);document.querySelector("#menuControl")[0].classList.add("mui-active");document.querySelector("#news .mui-slider-item")[0].classList.add("mui-active");newsinit()}function bannerfn(e){var i=e;console.log(i);var n=i.LIST.length;var t="<div class='mui-slider-item mui-slider-item-duplicate'><a newsid='"+i.LIST[i.LIST.length-1].news_id+"'><img src='"+i.LIST[i.LIST.length-1].pic_url+"' />";t+="<p class='mui-slider-title'>"+i.LIST[i.LIST.length-1].news_title+"</p></a></div>";var s="";for(var l=0;l<i.LIST.length;l++){t+="<div class='mui-slider-item'><a newsid='"+i.LIST[l].news_id+"'><img src='"+i.LIST[l].pic_url+"'><p class='mui-slider-title'>"+i.LIST[l].news_title+"</p></a></div>";s+="<div class='mui-indicator'></div>"}t+="<div class='mui-slider-item mui-slider-item-duplicate'><a newsid='"+i.LIST[0].news_id+"'><img src='"+i.LIST[0].pic_url+"' /><p class='mui-slider-title'>"+i.LIST[0].news_title+"</p></a></div>";document.getElementById("banner_con").innerHTML=t;document.getElementById("banslider").iinnerHTML=s}function newsinit(){var e=document.querySelector("#menuControl .mui-active").getAttribute("data");console.log(e);var i={classify_code:e,page_num:1,page_size:10};console.log(i);plus.nativeUI.closeWaiting();postServer("/api/v1/news/kx/focus/list",i,newsListFn)}document.querySelector("#slider").addEventListener("slide",function(e){var i=e.detail.slideNumber;var n=document.querySelectorAll("#menuControl a")[i].getAttribute("data");console.log(n);var t={classify_code:n,page_num:1,page_size:10};console.log(t)});function newsListFn(e){var i=JSON.parse(e);var n=document.querySelector("#menuControl .mui-active").getAttribute("href");var t="<ul class='mui-table-view'>";for(var s=0;s<i.LIST.length;s++){t+="<li class='mui-table-view-cell' newsid='"+i.LIST[s].news_id+"'>";t+="<img src='"+i.LIST[s].pic_url+"' class='newsimg'/>";t+="<div class='mui-pull-right'><h4>"+i.LIST[s].news_title+"</h4><span>"+i.LIST[s].issued_date+"</span>";t+="</div></li>"}t+="</ul>";document.getElementById(n).innerHTML=t}(function(e){var i=mui.os.ios?.003:9e-4;e(".mui-scroll-wrapper").scroll({bounce:false,indicators:true,deceleration:i});e.ready(function(){e.each(document.querySelectorAll(".news .mui-scroll"),function(i,n){e(n).pullToRefresh({down:{auto:false,callback:function(){var e=this;setTimeout(function(){e.endPullDownToRefresh()},1e3)}},up:{auto:false,contentnomore:"没有更多数据了",callback:function(){var e=this;setTimeout(function(){e.endPullUpToRefresh()},1e3)}}})})})})(mui);mui("#bannerslider").on("tap","a",function(){plus.nativeUI.showWaiting();var e=plus.webview.create("news_detail.html","news_detail.html",{},{newsId:this.getAttribute("newsid")});e.addEventListener("loaded",function(){e.show("slide-in-right")},false)});mui("#news").on("tap","li",function(){plus.nativeUI.showWaiting();var e=plus.webview.create("news_detail.html","news_detail.html",{},{newsId:this.getAttribute("newsid")});e.addEventListener("loaded",function(){e.show("slide-in-right")},false)});