mui.init({gestureConfig:{tap:true,doubletap:true,longtap:true,swipe:true,drag:true,hold:false,release:false}});if(window.plus){plusReady()}else{document.addEventListener("plusready",plusReady,false)}var news_id;var news_title;var clipContent;function plusReady(){var e=plus.webview.currentWebview();news_title=e.news_title;clipContent=JSON.parse(e.clipContent);console.log(clipContent);var t="<ul id='clipcon' >";for(var s=0;s<clipContent.cuttime.length;s++){t+="<li class='con'><img src='../src/img/dragupdown@2x.png' class='dragbtn'/><p class='scon'>"+clipContent.cuttext[s]+"</p><span class='stime'>["+clipContent.cuttime[s]+"]　</span><span class='mui-pull-right del'>删除</span></li>"}t+="</ul>";document.getElementById("box").innerHTML=t;var n=$("li").length;for(var s=0;s<n;s++){var i=$(".con").eq(s).height();$(".dragbtn").eq(s).css("top",(i-25)/2);$(".del").eq(s).on("tap",function(){$(this).parent().remove();$(this).css({"-webkit-transform":"translateX(0px)","-webkit-transition":"all .5s"})})}var o;var l=0;document.getElementById("fixcon").addEventListener("tap",function(){var e=$("#box").html();var t=document.getElementById("toSay").value;var s=new Date;var n=s.toLocaleString();if(localStorage.getItem("myNotes")){o=JSON.parse(localStorage.getItem("myNotes"));var i=o.noteId.length;l=o.noteId[i-1];o.noteId.push(l+1);o.newsId.push(news_id);o.newsTitle.push(news_title);o.clipContent.push(e);o.myTalk.push(t);o.dateTime.push(n)}else{o={noteId:[],newsId:[],newsTitle:[],clipContent:[],myTalk:[],dateTime:[]};o.noteId.push(l);o.newsId.push(news_id);o.newsTitle.push(news_title);o.clipContent.push(e);o.myTalk.push(t);o.dateTime.push(n)}localStorage.setItem("myNotes",JSON.stringify(o));var a=plus.webview.create("board_detail.html","board_detail.html",{},{noteId:l+1});a.addEventListener("loaded",function(){a.show("slide-in-right")},false)})}function getMousePos(e){return{x:e.detail.touches[0].clientX||e.targetTouches[0].clientX+document.body.scrollLeft,y:e.detail.touches[0].clientY||e.targetTouches[0].clientY+document.body.scrollTop}}function getElementPos(e){return{x:e.offsetParent?e.offsetLeft+arguments.callee(e.offsetParent)["x"]:e.offsetLeft,y:e.offsetParent?e.offsetTop+arguments.callee(e.offsetParent)["y"]:e.offsetTop}}function getElementSize(e){return{width:e.offsetWidth,height:e.offsetHeight}}function preventD(e){e.preventDefault()}function draging(e){e=e||window.event;var s=getMousePos(e);for(var n=0;n<lis.length;n++){if(s.x>lis[n]["pos"]["x"]&&s.x<lis[n]["pos"]["x"]+lis[n]["size"]["width"]&&s.y+h>lis[n]["pos"]["y"]&&s.y+h<lis[n]["pos"]["y"]+lis[n]["size"]["height"]/2){if(t!=lis[n]){MOVE.isMove=true;clipcon.insertBefore(adddiv,lis[n])}}else if(s.x>lis[n]["pos"]["x"]&&s.x<lis[n]["pos"]["x"]+lis[n]["size"]["width"]&&s.y>lis[n]["pos"]["y"]+lis[n]["size"]["height"]/2&&s.y<lis[n]["pos"]["y"]+lis[n]["size"]["height"]){if(t!=lis[n]){MOVE.isMove=true;clipcon.insertBefore(adddiv,lis[n].nextSibling)}}}}var MOVE={};MOVE.isMove=false;var t,p,pos,el,h;var lis;var adddiv=document.createElement("div");adddiv.style.width="100%";adddiv.style.height="5px";adddiv.style.fontSize="0";mui("#box").on("longtap",".con",function(e){$(this).css("background","rgba(0,0,0,0.05)");$(this).find(".dragbtn").css("display","block");$(this).css("boxShadow","0px 0px 8px #AAAAAA");this.addEventListener("touchmove",preventD,false);lis=document.querySelectorAll(".con");for(var s=0;s<lis.length;s++){lis[s]["pos"]=getElementPos(lis[s]);lis[s]["size"]=getElementSize(lis[s])}h=document.body.scrollTop;e=e||window.event;t=this;p=getMousePos(e);pos=getElementPos(this);el=t.cloneNode(true);el.style.position="absolute";el.style.display="none";el.style.left=pos.x+"px";el.style.top=pos.y+"px";document.body.appendChild(el);this.addEventListener("drag",draging,false);this.addEventListener("dragend",function(e){e=e||window.event;this.removeEventListener("touchmove",preventD,false);this.removeEventListener("drag",draging,false);if(MOVE.isMove){el.style.display="block";clipcon.replaceChild(t,adddiv);MOVE.isMove=false}if(el){document.body.removeChild(el)}$(this).css("background","#ffffff");$(this).find(".dragbtn").css("display","none");$(this).css("boxShadow","none")},false);$(".mui-content").on("tap",function(){this.removeEventListener("touchmove",preventD,false);document.body.removeChild(el);$("li").css("backgroundColor","#ffffff");$(".dragbtn").css("display","none")})});